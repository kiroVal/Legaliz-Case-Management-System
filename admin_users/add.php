<?php require_once __DIR__ . '/../partials/header.php'; if(!is_admin()){ http_response_code(403); die('Admins only'); } if($_SERVER['REQUEST_METHOD']==='POST'){ csrf_verify(); $hash=password_hash($_POST['password'],PASSWORD_DEFAULT); $stmt=$pdo->prepare('INSERT INTO users (name,email,password,role) VALUES (?,?,?,?)'); $stmt->execute([$_POST['name'],$_POST['email'],$hash,$_POST['role']]); if($_POST['role']==='client'){ $uid=$pdo->lastInsertId(); $stmt2=$pdo->prepare('INSERT INTO clients (user_id,name,email) VALUES (?,?,?)'); $stmt2->execute([$uid,$_POST['name'],$_POST['email']]); } header('Location: /admin_users/list.php'); exit; } ?>
<h3>Add User</h3>
<form method='post'><?php csrf_field(); ?><input name='name' class='form-control mb-2' placeholder='Name' required><input name='email' class='form-control mb-2' placeholder='Email' required><input name='password' type='password' class='form-control mb-2' placeholder='Password' required><select name='role' class='form-select mb-2'><option value='client'>client</option><option value='lawyer'>lawyer</option><option value='staff'>staff</option><option value='admin'>admin</option></select><button class='btn btn-primary'>Create</button></form><?php require_once __DIR__ . '/../partials/footer.php'; ?>